<Window x:Class="KindergartenManagement.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:KindergartenManagement.ViewModels"
        xmlns:util="clr-namespace:KindergartenManagement.Utilities"
        xmlns:conv="clr-namespace:KindergartenManagement.Converters"
        mc:Ignorable="d"
        Title="Há»‡ thá»‘ng quáº£n lÃ½ máº§m non" 
        Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="{StaticResource BackgroundColor}">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <conv:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
        <conv:StatusToVietnameseConverter x:Key="StatusToVietnameseConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Grid.Column="0" 
                Background="{StaticResource PrimaryColor}"
                Padding="0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Margin="20">
                    <TextBlock Text="ðŸ«"
                              FontSize="40"
                              Foreground="White"
                              HorizontalAlignment="Center"/>
                    <TextBlock Text="Quáº£n lÃ½ máº§m non"
                              FontSize="16"
                              FontWeight="Bold"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              Margin="0,10,0,0"/>
                    <TextBlock Text="{Binding CurrentAccount.Username}"
                              FontSize="12"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              Margin="0,5,0,0"
                              Opacity="0.8"/>
                </StackPanel>

                <!-- Navigation Menu -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="0,20,0,0">
                        <Button Content="ðŸ“Š Tá»•ng quan"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Dashboard"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ‘¶ Quáº£n lÃ½ há»c sinh"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Students"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ‘ª Quáº£n lÃ½ phá»¥ huynh"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Parents"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ‘¨â€ðŸ’¼ Quáº£n lÃ½ nhÃ¢n viÃªn"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Staff"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ” Quáº£n lÃ½ tÃ i khoáº£n"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Accounts"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ« Quáº£n lÃ½ lá»›p há»c"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Classes"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ“š Quáº£n lÃ½ khá»‘i lá»›p"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Grades"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="âœ… Äiá»ƒm danh"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Attendance"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ’Š Sá»©c khá»e"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Health"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ï¿½ Quáº£n lÃ½ Vaccine"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Vaccines"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ“‹ Há»“ sÆ¡ tiÃªm chá»§ng"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="VaccinationRecords"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ¥ Há»“ sÆ¡ sá»©c khá»e thÃ¡ng"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="HealthRecords"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ï¿½ðŸ“… ÄÆ¡n nghá»‰ nhÃ¢n viÃªn"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="StaffLeave"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ½ï¸ Thá»±c Ä‘Æ¡n"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Menu"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                        
                        <Button Content="ðŸ’° HÃ³a Ä‘Æ¡n"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Invoice"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,5"/>
                    </StackPanel>
                </ScrollViewer>

                <!-- Logout Button -->
                <Button Grid.Row="2"
                       Content="ðŸšª ÄÄƒng xuáº¥t"
                       Command="{Binding LogoutCommand}"
                       Style="{StaticResource MenuButton}"
                       Foreground="White"
                       Margin="0,0,0,20"/>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Border Grid.Column="1" 
                Background="{StaticResource BackgroundColor}"
                Padding="20">
            <ContentControl Content="{Binding CurrentViewModel}">
                <ContentControl.Resources>
                    <!-- Dashboard View -->
                    <DataTemplate DataType="{x:Type vm:DashboardViewModel}">
                        <Border Background="{StaticResource SurfaceColor}"
                               CornerRadius="10"
                               Padding="30">
                            <StackPanel>
                                <TextBlock Text="Tá»•ng quan há»‡ thá»‘ng"
                                         FontSize="28"
                                         FontWeight="Bold"
                                         Foreground="{StaticResource PrimaryColor}"
                                         Margin="0,0,0,20"/>
                                
                                <TextBlock Text="{Binding WelcomeMessage}"
                                         FontSize="16"
                                         Foreground="{StaticResource TextSecondaryColor}"/>

                                <!-- Statistics Cards -->
                                <UniformGrid Columns="4" Margin="0,30,0,0">
                                    <!-- Student Card -->
                                    <Border Background="{StaticResource PrimaryLightColor}"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘¶" FontSize="40"/>
                                            <TextBlock Text="Há»c sinh" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="{StaticResource PrimaryColor}"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Class Card -->
                                    <Border Background="#E8F5E9"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ«" FontSize="40"/>
                                            <TextBlock Text="Lá»›p há»c" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="#4CAF50"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Grade Card -->
                                    <Border Background="#FFF3E0"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“š" FontSize="40"/>
                                            <TextBlock Text="Khá»‘i lá»›p" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="{StaticResource SuccessColor}"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Teacher Card -->
                                    <Border Background="#FFF3E0"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘¨â€ðŸ«" FontSize="40"/>
                                            <TextBlock Text="GiÃ¡o viÃªn" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="{StaticResource AccentColor}"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Parent Card -->
                                    <Border Background="#FCE4EC"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘ª" FontSize="40"/>
                                            <TextBlock Text="Phá»¥ huynh" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="#E91E63"/>
                                        </StackPanel>
                                    </Border>
                                </UniformGrid>
                            </StackPanel>
                        </Border>
                    </DataTemplate>

                    <!-- Student Management View -->
                    <DataTemplate DataType="{x:Type vm:StudentManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Student List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch há»c sinh" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Students}" SelectedItem="{Binding SelectedStudent}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há» vÃ  tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="NgÃ y sinh" Binding="{Binding DateOfBirth, StringFormat={}{0:dd/MM/yyyy}}" Width="90" MinWidth="90"/>
                                            <DataGridTextColumn Header="Lá»›p" Binding="{Binding Class.Name}" Width="100" MinWidth="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Student Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin há»c sinh" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddStudentCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p há»c sinh má»›i"/>
                                        </Grid>

                                        <TextBlock Text="Há» vÃ  tÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.FullName, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="NgÃ y sinh *" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedStudent.DateOfBirth}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Giá»›i tÃ­nh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox Text="{Binding SelectedStudent.Gender}" IsEditable="True" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Nam"/>
                                            <ComboBoxItem Content="Ná»¯"/>
                                        </ComboBox>

                                        <TextBlock Text="Äá»‹a chá»‰" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.Address}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Ghi chÃº y táº¿" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.MedicalNotes, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="MÃ£ thá»±c pháº©m dá»‹ á»©ng" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.AllergyIngredientCodes, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" ToolTip="Nháº­p cÃ¡c mÃ£ thá»±c pháº©m gÃ¢y dá»‹ á»©ng, phÃ¢n cÃ¡ch báº±ng dáº¥u pháº©y" FontSize="12"/>

                                        <TextBlock Text="Phá»¥ huynh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Parents}" SelectedValue="{Binding SelectedStudent.ParentId}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Lá»›p" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Classes}" SelectedValue="{Binding SelectedStudent.ClassId}" SelectedValuePath="Id" DisplayMemberPath="Name" Padding="6" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveStudentCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin há»c sinh vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteStudentCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a há»c sinh Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Grade Management View -->
                    <DataTemplate DataType="{x:Type vm:GradeManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Grade List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch khá»‘i lá»›p" FontSize="24" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                    <DataGrid ItemsSource="{Binding Grades}" SelectedItem="{Binding SelectedGrade}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn khá»‘i" Binding="{Binding Name}" Width="*"/>
                                            <DataGridTextColumn Header="Äá»™ tuá»•i" Binding="{Binding MinAge, StringFormat={}{0} - }" Width="80"/>
                                            <DataGridTextColumn Header="" Binding="{Binding MaxAge, StringFormat={}{0} tuá»•i}" Width="80"/>
                                            <DataGridTextColumn Header="MÃ´ táº£" Binding="{Binding Description}" Width="200"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Grade Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <TextBlock Text="ThÃ´ng tin khá»‘i lá»›p" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,20"/>

                                        <TextBlock Text="TÃªn khá»‘i *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.Name, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Äá»™ tuá»•i tá»‘i thiá»ƒu *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.MinAge, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Äá»™ tuá»•i tá»‘i Ä‘a *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.MaxAge, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="MÃ´ táº£" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.Description, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,20" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddGradeCommand}" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p khá»‘i lá»›p má»›i"/>
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveGradeCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" ToolTip="LÆ°u thÃ´ng tin khá»‘i lá»›p vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteGradeCommand}" Style="{StaticResource DangerButton}" ToolTip="XÃ³a khá»‘i lá»›p Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Class Management View -->
                    <DataTemplate DataType="{x:Type vm:ClassManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Class List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch lá»›p há»c" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Classes}" SelectedItem="{Binding SelectedClass}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn lá»›p" Binding="{Binding Name}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Khá»‘i" Binding="{Binding Grade.Name}" Width="100" MinWidth="80"/>
                                            <DataGridTextColumn Header="SÄ© sá»‘ max" Binding="{Binding Capacity}" Width="80" MinWidth="70"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Class Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin lá»›p há»c" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddClassCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p lá»›p há»c má»›i"/>
                                        </Grid>

                                        <TextBlock Text="TÃªn lá»›p *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedClass.Name, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Khá»‘i *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Grades}" SelectedValue="{Binding SelectedClass.GradeId}" SelectedValuePath="Id" DisplayMemberPath="Name" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="GiÃ¡o viÃªn chá»§ nhiá»‡m" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Teachers}" SelectedValue="{Binding SelectedClass.TeacherId}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ há»c sinh tá»‘i Ä‘a *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedClass.Capacity}" Padding="6" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveClassCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin lá»›p há»c vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteClassCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a lá»›p há»c Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Attendance Management View -->
                    <DataTemplate DataType="{x:Type vm:AttendanceManagementViewModel}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Top: Filter Controls -->
                            <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Lá»›p há»c *" Margin="0,0,0,5"/>
                                        <ComboBox ItemsSource="{Binding Classes}" 
                                                  SelectedItem="{Binding SelectedClass}" 
                                                  DisplayMemberPath="Name" 
                                                  Padding="8"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Margin="0,0,15,0">
                                        <TextBlock Text="NgÃ y *" Margin="0,0,0,5"/>
                                        <DatePicker SelectedDate="{Binding SelectedDate}" Padding="8"/>
                                    </StackPanel>

                                    <Button Grid.Column="2" Content="ðŸ“‹ Táº¡o Ä‘iá»ƒm danh" 
                                            Command="{Binding CreateAttendanceCommand}" 
                                            Style="{StaticResource SecondaryButton}" 
                                            VerticalAlignment="Bottom" 
                                            Margin="0,0,10,0"
                                            ToolTip="Táº¡o báº£ng Ä‘iá»ƒm danh cho táº¥t cáº£ há»c sinh trong lá»›p"/>

                                    <Button Grid.Column="3" Content="ðŸ’¾ LÆ°u" 
                                            Command="{Binding SaveAttendanceCommand}" 
                                            Style="{StaticResource PrimaryButton}" 
                                            VerticalAlignment="Bottom"
                                            ToolTip="LÆ°u Ä‘iá»ƒm danh"/>
                                </Grid>
                            </Border>

                            <!-- Bottom: Attendance List -->
                            <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                <DataGrid ItemsSource="{Binding Attendances}" 
                                          AutoGenerateColumns="False" 
                                          CanUserAddRows="False">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Lá»›p" Binding="{Binding Class.Name}" Width="120" IsReadOnly="True"/>
                                        <DataGridTemplateColumn Header="Tráº¡ng thÃ¡i" Width="150">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{Binding DataContext.StatusList, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                              SelectedValue="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              SelectedValuePath="Value"
                                                              DisplayMemberPath="Display"
                                                              Padding="5"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Header="Ghi chÃº" Binding="{Binding Notes, UpdateSourceTrigger=PropertyChanged}" Width="200"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <DataTemplate DataType="{x:Type vm:HealthRecordViewModel}">
                        <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="30">
                            <TextBlock Text="Quáº£n lÃ½ sá»©c khá»e" FontSize="24" FontWeight="Bold"/>
                        </Border>
                    </DataTemplate>

                    <DataTemplate DataType="{x:Type vm:MenuManagementViewModel}">
                        <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="30">
                            <TextBlock Text="Quáº£n lÃ½ thá»±c Ä‘Æ¡n" FontSize="24" FontWeight="Bold"/>
                        </Border>
                    </DataTemplate>

                    <DataTemplate DataType="{x:Type vm:InvoiceManagementViewModel}">
                        <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="30">
                            <TextBlock Text="Quáº£n lÃ½ hÃ³a Ä‘Æ¡n" FontSize="24" FontWeight="Bold"/>
                        </Border>
                    </DataTemplate>

                    <!-- Account Management View -->
                    <DataTemplate DataType="{x:Type vm:AccountManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Account List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch tÃ i khoáº£n" FontSize="24" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                    <DataGrid ItemsSource="{Binding Accounts}" SelectedItem="{Binding SelectedAccount}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn Ä‘Äƒng nháº­p" Binding="{Binding Username}" Width="*"/>
                                            <DataGridTextColumn Header="Email" Binding="{Binding User.Email}" Width="*"/>
                                            <DataGridTextColumn Header="Vai trÃ²" Binding="{Binding Role.Name}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Account Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <TextBlock Text="ThÃ´ng tin tÃ i khoáº£n" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,20"/>

                                        <TextBlock Text="TÃªn Ä‘Äƒng nháº­p *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedAccount.Username, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Máº­t kháº©u *" Margin="0,0,0,5"/>
                                        <PasswordBox Padding="8" Margin="0,0,0,15"
                                                     util:PasswordBoxHelper.BindPassword="True"
                                                     util:PasswordBoxHelper.BoundPassword="{Binding NewPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                        <TextBlock Text="NhÃ¢n viÃªn *" Margin="0,0,0,5"/>
                                        <ComboBox ItemsSource="{Binding Users}" 
                                                  SelectedValue="{Binding SelectedUserId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="FullName" 
                                                  Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Email (tá»« nhÃ¢n viÃªn)" Margin="0,0,0,5" Foreground="Gray"/>
                                        <TextBox Text="{Binding SelectedUserEmail, Mode=OneWay}" 
                                                 IsReadOnly="True" 
                                                 Background="#F5F5F5"
                                                 Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Chá»©c vá»¥ (tá»« nhÃ¢n viÃªn)" Margin="0,0,0,5" Foreground="Gray"/>
                                        <TextBox Text="{Binding SelectedUserPosition, Mode=OneWay}" 
                                                 IsReadOnly="True" 
                                                 Background="#F5F5F5"
                                                 Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Vai trÃ² * (tá»± Ä‘á»™ng theo chá»©c vá»¥)" Margin="0,0,0,5"/>
                                        <ComboBox ItemsSource="{Binding Roles}" 
                                                  SelectedValue="{Binding SelectedAccount.RoleId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="Name" 
                                                  Padding="8" Margin="0,0,0,15"/>

                                        <CheckBox Content="KÃ­ch hoáº¡t tÃ i khoáº£n" IsChecked="{Binding SelectedAccount.IsActive, Mode=TwoWay}" Margin="0,0,0,20"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddAccountCommand}" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p tÃ i khoáº£n má»›i"/>
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveAccountCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" ToolTip="LÆ°u thÃ´ng tin tÃ i khoáº£n vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteAccountCommand}" Style="{StaticResource DangerButton}" ToolTip="XÃ³a tÃ i khoáº£n Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Staff Management View -->
                    <DataTemplate DataType="{x:Type vm:StaffManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Staff List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch nhÃ¢n viÃªn" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Staff}" SelectedItem="{Binding SelectedStaff}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há» vÃ  tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="*" MinWidth="120"/>
                                            <DataGridTextColumn Header="Chá»©c vá»¥" Binding="{Binding Position}" Width="100" MinWidth="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Staff Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin nhÃ¢n viÃªn" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddStaffCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p nhÃ¢n viÃªn má»›i"/>
                                        </Grid>

                                        <TextBlock Text="Há» vÃ  tÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.FullName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Email *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ Ä‘iá»‡n thoáº¡i" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.PhoneNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Chá»©c vá»¥ *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox Text="{Binding SelectedStaff.Position, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEditable="True" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="GiÃ¡o viÃªn"/>
                                            <ComboBoxItem Content="Hiá»‡u trÆ°á»Ÿng"/>
                                            <ComboBoxItem Content="PhÃ³ hiá»‡u trÆ°á»Ÿng"/>
                                            <ComboBoxItem Content="Káº¿ toÃ¡n"/>
                                            <ComboBoxItem Content="Y tÃ¡"/>
                                        </ComboBox>

                                        <TextBlock Text="LÆ°Æ¡ng cÆ¡ báº£n" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Salary, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Phá»¥ cáº¥p" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Allowance, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="ChuyÃªn mÃ´n" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Specialization, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveStaffCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin nhÃ¢n viÃªn vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteStaffCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a nhÃ¢n viÃªn Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Parent Management View -->
                    <DataTemplate DataType="{x:Type vm:ParentManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Parent List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch phá»¥ huynh" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Parents}" SelectedItem="{Binding SelectedParent}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há» vÃ  tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="*" MinWidth="120"/>
                                            <DataGridTextColumn Header="ÄT" Binding="{Binding PhoneNumber}" Width="100" MinWidth="90"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Parent Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin phá»¥ huynh" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddParentCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p phá»¥ huynh má»›i"/>
                                        </Grid>

                                        <TextBlock Text="Há» vÃ  tÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.FullName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Email *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ Ä‘iá»‡n thoáº¡i *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.PhoneNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Nghá» nghiá»‡p" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.Occupation, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Äá»‹a chá»‰" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.Address, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,15" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveParentCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin phá»¥ huynh vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteParentCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a phá»¥ huynh Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Staff Leave Management View -->
                    <DataTemplate DataType="{x:Type vm:StaffLeaveManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="400"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Staff Leave List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch Ä‘Æ¡n nghá»‰ nhÃ¢n viÃªn" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding StaffLeaves}" SelectedItem="{Binding SelectedLeave, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="NhÃ¢n viÃªn" Binding="{Binding User.FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Tá»«" Binding="{Binding StartDate, StringFormat={}{0:dd/MM/yyyy}}" Width="80" MinWidth="70"/>
                                            <DataGridTextColumn Header="Äáº¿n" Binding="{Binding EndDate, StringFormat={}{0:dd/MM/yyyy}}" Width="80" MinWidth="70"/>
                                            <DataGridTextColumn Header="Loáº¡i" Binding="{Binding LeaveType, Converter={StaticResource StatusToVietnameseConverter}}" Width="100" MinWidth="90"/>
                                            <DataGridTextColumn Header="TT" Binding="{Binding Status, Converter={StaticResource StatusToVietnameseConverter}}" Width="90" MinWidth="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Staff Leave Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin Ä‘Æ¡n nghá»‰" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddLeaveCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p Ä‘Æ¡n nghá»‰ má»›i"/>
                                        </Grid>

                                        <TextBlock Text="NhÃ¢n viÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Users}" 
                                                  SelectedValue="{Binding SelectedLeave.UserId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="FullName"
                                                  IsEnabled="{Binding CanSelectUser}"
                                                  Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Tá»« ngÃ y *" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedLeave.StartDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                    Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Äáº¿n ngÃ y *" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedLeave.EndDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                    Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Loáº¡i nghá»‰ *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding SelectedLeave.LeaveType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Tag" 
                                                  Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Nghá»‰ phÃ©p" Tag="Vacation"/>
                                            <ComboBoxItem Content="Nghá»‰ á»‘m" Tag="Sick"/>
                                            <ComboBoxItem Content="Nghá»‰ cÃ¡ nhÃ¢n" Tag="Personal"/>
                                            <ComboBoxItem Content="Nghá»‰ khÃ´ng lÆ°Æ¡ng" Tag="Unpaid"/>
                                        </ComboBox>

                                        <TextBlock Text="LÃ½ do *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedLeave.Reason, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Tráº¡ng thÃ¡i" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding TempStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Tag"
                                                  IsEnabled="{Binding CanEditStatus}"
                                                  Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Chá» duyá»‡t" Tag="Pending"/>
                                            <ComboBoxItem Content="ÄÃ£ duyá»‡t" Tag="Approved"/>
                                            <ComboBoxItem Content="Tá»« chá»‘i" Tag="Rejected"/>
                                        </ComboBox>

                                        <TextBlock Text="Ghi chÃº duyá»‡t" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedLeave.ApprovalNotes, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="6" Margin="0,0,0,15" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"
                                                 IsReadOnly="{Binding CanEditApprovalNotes, Converter={StaticResource InverseBooleanConverter}}"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveLeaveCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin Ä‘Æ¡n nghá»‰ vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteLeaveCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a Ä‘Æ¡n nghá»‰ Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Vaccine Management View -->
                    <DataTemplate DataType="{x:Type vm:VaccineManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="3*" MinWidth="400"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Vaccine List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch Vaccine" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Vaccines}" SelectedItem="{Binding SelectedVaccine, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn Vaccine" Binding="{Binding Name}" Width="*" MinWidth="120"/>
                                            <DataGridTextColumn Header="Tuá»•i (th)" Binding="{Binding RequiredAgeMonths}" Width="80" MinWidth="70"/>
                                            <DataGridCheckBoxColumn Header="BB" Binding="{Binding IsMandatory}" Width="60" MinWidth="50"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Vaccine Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin Vaccine" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddVaccineCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12"/>
                                        </Grid>

                                        <TextBlock Text="TÃªn Vaccine *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="MÃ´ táº£" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Tuá»•i yÃªu cáº§u (thÃ¡ng) *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.RequiredAgeMonths, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Bá»‡nh phÃ²ng ngá»«a" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.DiseasesPrevented, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <CheckBox Content="Vaccine báº¯t buá»™c" IsChecked="{Binding SelectedVaccine.IsMandatory, Mode=TwoWay}" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveVaccineCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteVaccineCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Vaccination Record Management View -->
                    <DataTemplate DataType="{x:Type vm:VaccinationRecordManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Record List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="Há»“ sÆ¡ tiÃªm chá»§ng" FontSize="24" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                        </Grid>

                                        <!-- Filter Section -->
                                        <TextBlock Text="ðŸ” Lá»c theo:" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="10"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Há»c sinh" Margin="0,0,0,5" FontSize="12"/>
                                                <ComboBox ItemsSource="{Binding Students}" 
                                                          SelectedValue="{Binding FilterStudentId, Mode=TwoWay}" 
                                                          SelectedValuePath="Id" 
                                                          DisplayMemberPath="FullName" 
                                                          Padding="6" 
                                                          FontSize="12">
                                                    <ComboBox.ItemContainerStyle>
                                                        <Style TargetType="ComboBoxItem">
                                                            <Setter Property="Padding" Value="5"/>
                                                        </Style>
                                                    </ComboBox.ItemContainerStyle>
                                                </ComboBox>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="Vaccine" Margin="0,0,0,5" FontSize="12"/>
                                                <ComboBox ItemsSource="{Binding Vaccines}" 
                                                          SelectedValue="{Binding FilterVaccineId, Mode=TwoWay}" 
                                                          SelectedValuePath="Id" 
                                                          DisplayMemberPath="Name" 
                                                          Padding="6" 
                                                          FontSize="12">
                                                    <ComboBox.ItemContainerStyle>
                                                        <Style TargetType="ComboBoxItem">
                                                            <Setter Property="Padding" Value="5"/>
                                                        </Style>
                                                    </ComboBox.ItemContainerStyle>
                                                </ComboBox>
                                            </StackPanel>
                                        </Grid>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                                            <Button Content="ðŸ” Lá»c" Command="{Binding ApplyFilterCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" Padding="15,5"/>
                                            <Button Content="ðŸ”„ XÃ³a lá»c" Command="{Binding ClearFilterCommand}" Style="{StaticResource SecondaryButton}" Padding="15,5"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                    <DataGrid ItemsSource="{Binding FilteredRecords}" SelectedItem="{Binding SelectedRecord, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*"/>
                                            <DataGridTextColumn Header="Vaccine" Binding="{Binding Vaccine.Name}" Width="*"/>
                                            <DataGridTextColumn Header="Tráº¡ng thÃ¡i" Binding="{Binding Status}" Width="100"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Record Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin tiÃªm chá»§ng" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddRecordCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12"/>
                                        </Grid>

                                        <TextBlock Text="Há»c sinh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Students}" SelectedValue="{Binding SelectedRecord.StudentId, Mode=TwoWay}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Vaccine *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Vaccines}" SelectedValue="{Binding SelectedRecord.VaccineId, Mode=TwoWay}" SelectedValuePath="Id" DisplayMemberPath="Name" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Tráº¡ng thÃ¡i" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding SelectedRecord.Status, Mode=TwoWay}" SelectedValuePath="Tag" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="ChÆ°a tiÃªm" Tag="Not Done"/>
                                            <ComboBoxItem Content="ÄÃ£ tiÃªm" Tag="Done"/>
                                            <ComboBoxItem Content="ÄÃ£ lÃªn lá»‹ch" Tag="Scheduled"/>
                                        </ComboBox>

                                        <TextBlock Text="NgÃ y tiÃªm" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedRecord.VaccinationDate, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="ÄÆ¡n vá»‹ y táº¿" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.MedicalUnit, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ lÃ´" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.LotNumber, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Ghi chÃº" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.Notes, Mode=TwoWay}" Padding="6" Margin="0,0,0,15" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveRecordCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteRecordCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Health Record Management View -->
                    <DataTemplate DataType="{x:Type vm:HealthRecordManagementViewModel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="3*" MinWidth="400"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Health Record List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="Há»“ sÆ¡ sá»©c khá»e hÃ ng thÃ¡ng" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5"/>
                                        </Grid>

                                        <!-- Filter Section -->
                                        <TextBlock Text="ðŸ” Lá»c theo lá»›p há»c:" FontSize="13" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                        
                                        <ComboBox ItemsSource="{Binding Classes}" 
                                                  SelectedValue="{Binding FilterClassId, Mode=TwoWay}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="Name" 
                                                  Padding="6" 
                                                  FontSize="12"
                                                  Margin="0,0,0,8"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ” Lá»c" Command="{Binding ApplyFilterCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="12,5" FontSize="12"/>
                                            <Button Content="ðŸ”„ XÃ³a lá»c" Command="{Binding ClearFilterCommand}" Style="{StaticResource SecondaryButton}" Padding="12,5" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Students List (visible when class is filtered) -->
                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,10">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Text="ðŸ‘¥ Danh sÃ¡ch há»c sinh" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                        
                                        <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredStudents}" SelectedItem="{Binding SelectedStudent, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="MÃ£ HS" Binding="{Binding Code}" Width="70" MinWidth="70"/>
                                                <DataGridTextColumn Header="Há» tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="120"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="2" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding FilteredRecords}" SelectedItem="{Binding SelectedRecord, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="ThÃ¡ng/NÄƒm" Width="80" MinWidth="80">
                                                <DataGridTextColumn.Binding>
                                                    <MultiBinding StringFormat="{}{0}/{1}">
                                                        <Binding Path="Month"/>
                                                        <Binding Path="Year"/>
                                                    </MultiBinding>
                                                </DataGridTextColumn.Binding>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="CC(cm)" Binding="{Binding Height}" Width="70" MinWidth="70"/>
                                            <DataGridTextColumn Header="CN(kg)" Binding="{Binding Weight}" Width="70" MinWidth="70"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Health Record Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin sá»©c khá»e" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddRecordCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12"/>
                                        </Grid>

                                        <TextBlock Text="Há»c sinh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Students}" SelectedValue="{Binding SelectedRecord.StudentId, Mode=TwoWay}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="10"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="ThÃ¡ng *" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Month, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="NÄƒm *" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Year, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>
                                        </Grid>

                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="10"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Chiá»u cao (cm)" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Height, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="CÃ¢n náº·ng (kg)" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Weight, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>
                                        </Grid>

                                        <TextBlock Text="Sá»©c khá»e tá»•ng quÃ¡t" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding SelectedRecord.GeneralHealth, Mode=TwoWay}" SelectedValuePath="Tag" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Tá»‘t" Tag="Good"/>
                                            <ComboBoxItem Content="KhÃ¡" Tag="Fair"/>
                                            <ComboBoxItem Content="Yáº¿u" Tag="Poor"/>
                                        </ComboBox>

                                        <TextBlock Text="TÃ¬nh tráº¡ng bá»‡nh lÃ½" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.MedicalConditions, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Nháº­n xÃ©t cá»§a giÃ¡o viÃªn" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.TeacherComments, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="ÄÃ¡nh giÃ¡ cá»§a giÃ¡o viÃªn" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.TeacherEvaluation, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Ghi chÃº" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.Notes, Mode=TwoWay}" Padding="6" Margin="0,0,0,15" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveRecordCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteRecordCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>
                </ContentControl.Resources>
            </ContentControl>
        </Border>
    </Grid>
</Window>
