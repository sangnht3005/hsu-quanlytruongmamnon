<Window x:Class="KindergartenManagement.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:KindergartenManagement.ViewModels"
        xmlns:util="clr-namespace:KindergartenManagement.Utilities"
        xmlns:conv="clr-namespace:KindergartenManagement.Converters"
        mc:Ignorable="d"
        Title="Há»‡ thá»‘ng quáº£n lÃ½ máº§m non" 
        Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="{StaticResource BackgroundColor}">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <conv:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
        <conv:StatusToVietnameseConverter x:Key="StatusToVietnameseConverter"/>
        <conv:PageToTagConverter x:Key="PageToTagConverter"/>
        <conv:NullToBoolConverter x:Key="NullToBoolConverter"/>
        <!-- Sidebar section header style -->
        <Style x:Key="SidebarSectionHeader" TargetType="TextBlock">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Opacity" Value="0.75"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Margin" Value="15,16,0,8"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
            <Setter Property="Foreground" Value="#B3E5FC"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Grid.Column="0" 
            Background="{StaticResource SidebarGradient}"
                Padding="0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Margin="20">
                    <TextBlock Text="ðŸ«"
                              FontSize="40"
                              Foreground="White"
                              HorizontalAlignment="Center"/>
                    <TextBlock Text="Quáº£n lÃ½ máº§m non"
                              FontSize="16"
                              FontWeight="Bold"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              Margin="0,10,0,0"/>
                    <TextBlock Text="{Binding CurrentAccount.Username}"
                              FontSize="12"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              Margin="0,5,0,0"
                              Opacity="0.8"/>
                </StackPanel>

                <!-- Navigation Menu -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="0,10,0,0">
                        <!-- Dashboard -->
                        <Button Content="ðŸ“Š Tá»•ng quan"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Dashboard"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Dashboard}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <!-- Students & Parents Section -->
                        <TextBlock Text="ðŸ‘¶ Há»ŒC SINH" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   Danh sÃ¡ch há»c sinh"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Students"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Students}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   Phá»¥ huynh"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Parents"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Parents}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,8"/>
                        
                        <!-- Classes & Attendance Section -->
                        <TextBlock Text="ðŸ« Lá»šP Há»ŒC" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   Khá»‘i lá»›p"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Grades"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Grades}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   Quáº£n lÃ½ lá»›p"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Classes"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Classes}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   Äiá»ƒm danh"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Attendance"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Attendance}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,8"/>
                        
                        <!-- Health & Vaccines Section -->
                        <TextBlock Text="ðŸ’Š Sá»¨C KHá»ŽE" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   Há»“ sÆ¡ sá»©c khá»e"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Health"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Health}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   Vaccine"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Vaccines"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Vaccines}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   TiÃªm chá»§ng"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="VaccinationRecords"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=VaccinationRecords}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   Há»“ sÆ¡ thÃ¡ng"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="HealthRecords"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=HealthRecords}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,8"/>
                        
                        <!-- Nutrition Management Section -->
                        <TextBlock Text="ðŸ½ï¸ THá»°C ÄÆ N" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   Thá»±c Ä‘Æ¡n"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Menu"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Menu}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   Menu háº±ng ngÃ y"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="DailyMenus"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=DailyMenus}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   Phiáº¿u Äƒn"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="MealTickets"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=MealTickets}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   NhÃ  cung cáº¥p"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Suppliers"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Suppliers}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   NguyÃªn liá»‡u"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Ingredients"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Ingredients}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   MÃ³n Äƒn"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Dishes"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Dishes}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,8"/>
                        
                        <!-- Staff & Finance Section -->
                        <TextBlock Text="ðŸ‘¨â€ðŸ’¼ NHÃ‚N Sá»°" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   NhÃ¢n viÃªn"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Staff"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Staff}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                        
                        <Button Content="   ÄÆ¡n nghá»‰"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="StaffLeave"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=StaffLeave}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,8"/>
                        
                        <!-- Finance Section -->
                        <TextBlock Text="ðŸ’° TÃ€I CHÃNH" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   HÃ³a Ä‘Æ¡n"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Invoice"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Invoice}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,8"/>
                        
                        <!-- Reporting Section -->
                        <TextBlock Text="ðŸ“ˆ BÃO CÃO" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   BÃ¡o cÃ¡o"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Reporting"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Reporting}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,8"/>
                        
                        <!-- System Section -->
                        <TextBlock Text="ðŸ” Há»† THá»NG" Style="{StaticResource SidebarSectionHeader}"/>
                        
                        <Button Content="   TÃ i khoáº£n"
                               Command="{Binding NavigateCommand}"
                               CommandParameter="Accounts"
                               Tag="{Binding CurrentPage, Converter={StaticResource PageToTagConverter}, ConverterParameter=Accounts}"
                               Style="{StaticResource MenuButton}"
                               Foreground="White"
                               Margin="0,0,0,3"/>
                    </StackPanel>
                </ScrollViewer>

                <!-- Logout Button -->
                <Button Grid.Row="2"
                       Content="ðŸšª ÄÄƒng xuáº¥t"
                       Command="{Binding LogoutCommand}"
                       Style="{StaticResource MenuButton}"
                       Foreground="White"
                       Margin="0,0,0,20"/>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Border Grid.Column="1" 
                Background="{StaticResource BackgroundColor}"
                Padding="20">
            <ContentControl Content="{Binding CurrentViewModel}">
                <ContentControl.Resources>
                    <!-- Dashboard View -->
                    <DataTemplate DataType="{x:Type vm:DashboardViewModel}">
                        <Border Background="{StaticResource SurfaceColor}"
                               CornerRadius="10"
                               Padding="30">
                            <StackPanel>
                                <TextBlock Text="Tá»•ng quan há»‡ thá»‘ng"
                                         FontSize="28"
                                         FontWeight="Bold"
                                         Foreground="{StaticResource PrimaryColor}"
                                         Margin="0,0,0,20"/>
                                
                                <TextBlock Text="{Binding WelcomeMessage}"
                                         FontSize="16"
                                         Foreground="{StaticResource TextSecondaryColor}"/>

                                <!-- Statistics Cards -->
                                <UniformGrid Columns="4" Margin="0,30,0,0">
                                    <!-- Student Card -->
                                    <Border Background="{StaticResource PrimaryLightColor}"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘¶" FontSize="40"/>
                                            <TextBlock Text="Há»c sinh" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="{StaticResource PrimaryColor}"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Class Card -->
                                    <Border Background="#E8F5E9"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ«" FontSize="40"/>
                                            <TextBlock Text="Lá»›p há»c" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="#4CAF50"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Grade Card -->
                                    <Border Background="#FFF3E0"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“š" FontSize="40"/>
                                            <TextBlock Text="Khá»‘i lá»›p" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="{StaticResource SuccessColor}"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Teacher Card -->
                                    <Border Background="#FFF3E0"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘¨â€ðŸ«" FontSize="40"/>
                                            <TextBlock Text="GiÃ¡o viÃªn" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="{StaticResource AccentColor}"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Parent Card -->
                                    <Border Background="#FCE4EC"
                                           CornerRadius="8"
                                           Padding="20"
                                           Margin="5">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘ª" FontSize="40"/>
                                            <TextBlock Text="Phá»¥ huynh" 
                                                     FontSize="14" 
                                                     Foreground="{StaticResource TextSecondaryColor}"
                                                     Margin="0,10,0,5"/>
                                            <TextBlock Text="0" 
                                                     FontSize="28" 
                                                     FontWeight="Bold"
                                                     Foreground="#E91E63"/>
                                        </StackPanel>
                                    </Border>
                                </UniformGrid>
                            </StackPanel>
                        </Border>
                    </DataTemplate>

                    <!-- Student Management View -->
                    <DataTemplate DataType="{x:Type vm:StudentManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Student List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch há»c sinh" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Students}" SelectedItem="{Binding SelectedStudent}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há» vÃ  tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="NgÃ y sinh" Binding="{Binding DateOfBirth, StringFormat={}{0:dd/MM/yyyy}}" Width="90" MinWidth="90"/>
                                            <DataGridTextColumn Header="Lá»›p" Binding="{Binding Class.Name}" Width="100" MinWidth="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Student Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin há»c sinh" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddStudentCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p há»c sinh má»›i"/>
                                        </Grid>

                                        <TextBlock Text="Há» vÃ  tÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.FullName, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="NgÃ y sinh *" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedStudent.DateOfBirth}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Giá»›i tÃ­nh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox Text="{Binding SelectedStudent.Gender}" IsEditable="True" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Nam"/>
                                            <ComboBoxItem Content="Ná»¯"/>
                                        </ComboBox>

                                        <TextBlock Text="Äá»‹a chá»‰" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.Address}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Ghi chÃº y táº¿" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.MedicalNotes, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="MÃ£ thá»±c pháº©m dá»‹ á»©ng" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStudent.AllergyIngredientCodes, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" ToolTip="Nháº­p cÃ¡c mÃ£ thá»±c pháº©m gÃ¢y dá»‹ á»©ng, phÃ¢n cÃ¡ch báº±ng dáº¥u pháº©y" FontSize="12"/>

                                        <TextBlock Text="Phá»¥ huynh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Parents}" SelectedValue="{Binding SelectedStudent.ParentId}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Lá»›p" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Classes}" SelectedValue="{Binding SelectedStudent.ClassId}" SelectedValuePath="Id" DisplayMemberPath="Name" Padding="6" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveStudentCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin há»c sinh vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteStudentCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a há»c sinh Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Grade Management View -->
                    <DataTemplate DataType="{x:Type vm:GradeManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Grade List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch khá»‘i lá»›p" FontSize="24" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                    <DataGrid ItemsSource="{Binding Grades}" SelectedItem="{Binding SelectedGrade}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn khá»‘i" Binding="{Binding Name}" Width="*"/>
                                            <DataGridTextColumn Header="Äá»™ tuá»•i" Binding="{Binding MinAge, StringFormat={}{0} - }" Width="80"/>
                                            <DataGridTextColumn Header="" Binding="{Binding MaxAge, StringFormat={}{0} tuá»•i}" Width="80"/>
                                            <DataGridTextColumn Header="MÃ´ táº£" Binding="{Binding Description}" Width="200"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Grade Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <TextBlock Text="ThÃ´ng tin khá»‘i lá»›p" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,20"/>

                                        <TextBlock Text="TÃªn khá»‘i *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.Name, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Äá»™ tuá»•i tá»‘i thiá»ƒu *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.MinAge, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Äá»™ tuá»•i tá»‘i Ä‘a *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.MaxAge, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="MÃ´ táº£" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedGrade.Description, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,20" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddGradeCommand}" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p khá»‘i lá»›p má»›i"/>
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveGradeCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" ToolTip="LÆ°u thÃ´ng tin khá»‘i lá»›p vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteGradeCommand}" Style="{StaticResource DangerButton}" ToolTip="XÃ³a khá»‘i lá»›p Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Daily Menu Management View -->
                    <DataTemplate DataType="{x:Type vm:DailyMenuManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="320"/>
                                <ColumnDefinition Width="3*" MinWidth="420"/>
                            </Grid.ColumnDefinitions>

                            <!-- Menus list -->
                            <Border Grid.Column="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12" Margin="0,0,10,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Grid Margin="0,0,0,10">
                                        <TextBlock Text="Thá»±c Ä‘Æ¡n háº±ng ngÃ y" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource PrimaryColor}"/>
                                        <Button Content="ðŸ” Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <DataGrid Grid.Row="1" ItemsSource="{Binding Menus}" SelectedItem="{Binding SelectedMenu}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Thá»©" Binding="{Binding DayOfWeek}" Width="60"/>
                                            <DataGridTextColumn Header="Bá»¯a" Binding="{Binding MealType}" Width="80"/>
                                            <DataGridTextColumn Header="TÃªn" Binding="{Binding Name}" Width="*"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Border>

                            <!-- Menu form and dishes -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,10">
                                            <TextBlock Text="ThÃ´ng tin thá»±c Ä‘Æ¡n" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource PrimaryColor}"/>
                                            <Button Content="âž• ThÃªm má»›i" Command="{Binding AddNewCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Border Background="#f7f7f7" CornerRadius="8" Padding="10" Margin="0,0,0,10">
                                            <StackPanel>
                                                <TextBlock Text="Táº¡o phiáº¿u khi Ä‘iá»ƒm danh cho cÃ¡c bá»¯a:" FontWeight="SemiBold"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                    <CheckBox Content="Breakfast" IsChecked="{Binding AutoBreakfast, Mode=TwoWay}" Margin="0,0,12,0"/>
                                                    <CheckBox Content="Lunch" IsChecked="{Binding AutoLunch, Mode=TwoWay}" Margin="0,0,12,0"/>
                                                    <CheckBox Content="Snack" IsChecked="{Binding AutoSnack, Mode=TwoWay}" Margin="0,0,12,0"/>
                                                    <CheckBox Content="Dinner" IsChecked="{Binding AutoDinner, Mode=TwoWay}"/>
                                                </StackPanel>
                                                <Button Content="ðŸ’¾ LÆ°u cáº¥u hÃ¬nh" Command="{Binding SaveAutoSettingsCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Margin="0,8,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Background="#f7f7f7" CornerRadius="8" Padding="10" Margin="0,0,0,10">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Táº¡o phiáº¿u Äƒn theo ngÃ y" FontWeight="SemiBold"/>
                                                    <DatePicker SelectedDate="{Binding GenerationDate, Mode=TwoWay}" Margin="0,6,0,0"/>
                                                </StackPanel>
                                                <Button Grid.Column="1" Content="ðŸŽ« Táº¡o phiáº¿u" Command="{Binding GenerateMealTicketsCommand}" Style="{StaticResource PrimaryButton}" Margin="8,22,0,0"/>
                                            </Grid>
                                        </Border>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0" Margin="0,0,6,0">
                                                <TextBlock Text="TÃªn *"/>
                                                <TextBox Text="{Binding Name, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                                <TextBlock Text="NgÃ y trong tuáº§n *"/>
                                                <ComboBox SelectedValue="{Binding DayOfWeek, Mode=TwoWay}" SelectedValuePath="Tag" Padding="6" Margin="0,0,0,8">
                                                    <ComboBoxItem Content="Chá»§ nháº­t" Tag="0"/>
                                                    <ComboBoxItem Content="Thá»© hai" Tag="1"/>
                                                    <ComboBoxItem Content="Thá»© ba" Tag="2"/>
                                                    <ComboBoxItem Content="Thá»© tÆ°" Tag="3"/>
                                                    <ComboBoxItem Content="Thá»© nÄƒm" Tag="4"/>
                                                    <ComboBoxItem Content="Thá»© sÃ¡u" Tag="5"/>
                                                    <ComboBoxItem Content="Thá»© báº£y" Tag="6"/>
                                                </ComboBox>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" Margin="6,0,0,0">
                                                <TextBlock Text="Loáº¡i bá»¯a *"/>
                                                <ComboBox Text="{Binding MealType, Mode=TwoWay}" IsEditable="False" Padding="6" Margin="0,0,0,8">
                                                    <ComboBoxItem Content="Breakfast"/>
                                                    <ComboBoxItem Content="Lunch"/>
                                                    <ComboBoxItem Content="Snack"/>
                                                    <ComboBoxItem Content="Dinner"/>
                                                </ComboBox>
                                                <TextBlock Text="MÃ´ táº£"/>
                                                <TextBox Text="{Binding Description, Mode=TwoWay}" Padding="6" Height="50" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Grid>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,6,0,0">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveMenuCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,6,0"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteMenuCommand}" Style="{StaticResource DangerButton}"/>
                                        </StackPanel>

                                        <Border Background="#f7f7f7" CornerRadius="8" Padding="10" Margin="0,12,0,0">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <TextBlock Text="MÃ³n Äƒn trong thá»±c Ä‘Æ¡n" FontWeight="SemiBold"/>
                                                <DataGrid Grid.Row="1" ItemsSource="{Binding MenuDishes}" SelectedItem="{Binding SelectedMenuDish}" AutoGenerateColumns="False" FontSize="11">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="MÃ³n" Binding="{Binding Dish.Name}" Width="*"/>
                                                        <DataGridTextColumn Header="Loáº¡i" Binding="{Binding Dish.Category}" Width="120"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Grid>
                                        </Border>

                                        <Border Background="#f7f7f7" CornerRadius="8" Padding="10" Margin="0,8,0,0">
                                            <StackPanel>
                                                <TextBlock Text="ThÃªm mÃ³n" FontWeight="SemiBold"/>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <ComboBox Grid.Column="0" ItemsSource="{Binding Dishes}" SelectedItem="{Binding SelectedDishToAdd}" DisplayMemberPath="Name" Padding="6" Margin="0,0,6,0"/>
                                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                        <Button Content="âž• ThÃªm" Command="{Binding AddDishCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,6,0"/>
                                                        <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding RemoveDishCommand}" Style="{StaticResource DangerButton}"/>
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Meal Ticket Management View -->
                    <DataTemplate DataType="{x:Type vm:MealTicketManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="3*" MinWidth="420"/>
                                <ColumnDefinition Width="2*" MinWidth="340"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12" Margin="0,0,10,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Text="Phiáº¿u Äƒn" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource PrimaryColor}"/>
                                    <Border Grid.Row="1" Background="#f7f7f7" CornerRadius="8" Padding="8" Margin="0,8,0,8">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <DatePicker Grid.Column="0" SelectedDate="{Binding FilterDate, Mode=TwoWay}" Padding="6"/>
                                            <Button Grid.Column="1" Content="ðŸ” Lá»c" Command="{Binding ApplyFilterCommand}" Style="{StaticResource PrimaryButton}" Margin="8,0,0,0"/>
                                        </Grid>
                                    </Border>
                                    <DataGrid Grid.Row="2" ItemsSource="{Binding FilteredMealTickets}" SelectedItem="{Binding SelectedMealTicket}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*"/>
                                            <DataGridTextColumn Header="Lá»›p" Binding="{Binding Student.Class.Name}" Width="120"/>
                                            <DataGridTextColumn Header="Thá»±c Ä‘Æ¡n" Binding="{Binding Menu.Name}" Width="*"/>
                                            <DataGridTextColumn Header="NgÃ y" Binding="{Binding Date, StringFormat=dd/MM/yyyy}" Width="100"/>
                                            <DataGridCheckBoxColumn Header="ÄÃ£ dÃ¹ng" Binding="{Binding IsConsumed}" Width="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Border>
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12">
                                <StackPanel>
                                    <TextBlock Text="Chi tiáº¿t" FontSize="16" FontWeight="SemiBold"/>
                                    <TextBlock Text="ÄÃ£ sá»­ dá»¥ng" Margin="0,8,0,4"/>
                                    <CheckBox IsChecked="{Binding IsConsumed, Mode=TwoWay}"/>
                                    <TextBlock Text="Ghi chÃº" Margin="0,8,0,4"/>
                                    <TextBox Text="{Binding Notes, Mode=TwoWay}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                                        <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveMealTicketCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,6,0"/>
                                        <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteMealTicketCommand}" Style="{StaticResource DangerButton}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Supplier Management View -->
                    <DataTemplate DataType="{x:Type vm:SupplierManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="320"/>
                                <ColumnDefinition Width="3*" MinWidth="380"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12" Margin="0,0,10,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Grid Margin="0,0,0,10">
                                        <TextBlock Text="NhÃ  cung cáº¥p" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource PrimaryColor}"/>
                                        <Button Content="ðŸ” Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <DataGrid Grid.Row="1" ItemsSource="{Binding Suppliers}" SelectedItem="{Binding SelectedSupplier}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn" Binding="{Binding Name}" Width="*"/>
                                            <DataGridTextColumn Header="SÄT" Binding="{Binding Phone}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Border>
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,10">
                                            <TextBlock Text="ThÃ´ng tin NCC" FontSize="16" FontWeight="SemiBold"/>
                                            <Button Content="âž• ThÃªm má»›i" Command="{Binding AddNewCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <TextBlock Text="TÃªn *"/>
                                        <TextBox Text="{Binding Name, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="NgÆ°á»i liÃªn há»‡"/>
                                        <TextBox Text="{Binding ContactPerson, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="Äiá»‡n thoáº¡i"/>
                                        <TextBox Text="{Binding Phone, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="Email"/>
                                        <TextBox Text="{Binding Email, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="Äá»‹a chá»‰"/>
                                        <TextBox Text="{Binding Address, Mode=TwoWay}" Padding="6" Height="60" TextWrapping="Wrap" AcceptsReturn="True" Margin="0,0,0,8"/>
                                        <TextBlock Text="Ghi chÃº"/>
                                        <TextBox Text="{Binding Notes, Mode=TwoWay}" Padding="6" Height="60" TextWrapping="Wrap" AcceptsReturn="True" Margin="0,0,0,8"/>
                                        <CheckBox Content="Äang hoáº¡t Ä‘á»™ng" IsChecked="{Binding IsActive, Mode=TwoWay}"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveSupplierCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,6,0"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteSupplierCommand}" Style="{StaticResource DangerButton}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Ingredient Management View -->
                    <DataTemplate DataType="{x:Type vm:IngredientManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="320"/>
                                <ColumnDefinition Width="3*" MinWidth="380"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12" Margin="0,0,10,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Grid Margin="0,0,0,10">
                                        <TextBlock Text="NguyÃªn liá»‡u" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource PrimaryColor}"/>
                                        <Button Content="ðŸ” Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <DataGrid Grid.Row="1" ItemsSource="{Binding Ingredients}" SelectedItem="{Binding SelectedIngredient}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn" Binding="{Binding Name}" Width="*"/>
                                            <DataGridTextColumn Header="ÄÆ¡n vá»‹" Binding="{Binding Unit}" Width="90"/>
                                            <DataGridTextColumn Header="GiÃ¡" Binding="{Binding UnitPrice, StringFormat=N0}" Width="100"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Border>
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,10">
                                            <TextBlock Text="ThÃ´ng tin nguyÃªn liá»‡u" FontSize="16" FontWeight="SemiBold"/>
                                            <Button Content="âž• ThÃªm má»›i" Command="{Binding AddNewCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <TextBlock Text="TÃªn *"/>
                                        <TextBox Text="{Binding Name, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="Loáº¡i"/>
                                        <TextBox Text="{Binding Category, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="ÄÆ¡n vá»‹ *"/>
                                        <TextBox Text="{Binding Unit, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="Calo/100g *"/>
                                        <TextBox Text="{Binding CaloriesPer100g, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="ÄÆ¡n giÃ¡ *"/>
                                        <TextBox Text="{Binding UnitPrice, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                        <TextBlock Text="NhÃ  cung cáº¥p"/>
                                        <ComboBox ItemsSource="{Binding Suppliers}" SelectedValue="{Binding SupplierId, Mode=TwoWay}" SelectedValuePath="Id" DisplayMemberPath="Name" Padding="6" Margin="0,0,0,8"/>
                                        <CheckBox Content="Äang hoáº¡t Ä‘á»™ng" IsChecked="{Binding IsActive, Mode=TwoWay}"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveIngredientCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,6,0"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteIngredientCommand}" Style="{StaticResource DangerButton}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Dish Management View -->
                    <DataTemplate DataType="{x:Type vm:DishManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="320"/>
                                <ColumnDefinition Width="3*" MinWidth="420"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12" Margin="0,0,10,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Grid Margin="0,0,0,10">
                                        <TextBlock Text="MÃ³n Äƒn" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource PrimaryColor}"/>
                                        <Button Content="ðŸ” Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <DataGrid Grid.Row="1" ItemsSource="{Binding Dishes}" SelectedItem="{Binding SelectedDish}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn" Binding="{Binding Name}" Width="*"/>
                                            <DataGridTextColumn Header="GiÃ¡ bÃ¡n" Binding="{Binding SellingPrice, StringFormat=N0}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Border>
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="12">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,10">
                                            <TextBlock Text="ThÃ´ng tin mÃ³n" FontSize="16" FontWeight="SemiBold"/>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                <Button Content="ðŸ§® TÃ­nh láº¡i" Command="{Binding RecalculateCommand}" Style="{StaticResource SecondaryButton}" Margin="0,0,6,0"/>
                                                <Button Content="âž• ThÃªm má»›i" Command="{Binding AddNewCommand}" Style="{StaticResource SecondaryButton}"/>
                                            </StackPanel>
                                        </Grid>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0" Margin="0,0,6,0">
                                                <TextBlock Text="TÃªn *"/>
                                                <TextBox Text="{Binding Name, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                                <TextBlock Text="Tá»•ng calo"/>
                                                <TextBox Text="{Binding TotalCalories}" IsReadOnly="True" Padding="6" Margin="0,0,0,8" Background="#f0f0f0"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" Margin="6,0,0,0">
                                                <TextBlock Text="GiÃ¡ bÃ¡n *"/>
                                                <TextBox Text="{Binding SellingPrice, Mode=TwoWay}" Padding="6" Margin="0,0,0,8"/>
                                                <TextBlock Text="Tá»•ng chi phÃ­"/>
                                                <TextBox Text="{Binding TotalCost}" IsReadOnly="True" Padding="6" Margin="0,0,0,8" Background="#f0f0f0"/>
                                            </StackPanel>
                                        </Grid>
                                        <CheckBox Content="Äang hoáº¡t Ä‘á»™ng" IsChecked="{Binding IsActive, Mode=TwoWay}"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveDishCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,6,0"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteDishCommand}" Style="{StaticResource DangerButton}"/>
                                        </StackPanel>

                                        <Border Background="#f7f7f7" CornerRadius="8" Padding="10" Margin="0,12,0,0">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <TextBlock Text="NguyÃªn liá»‡u trong mÃ³n" FontWeight="SemiBold"/>
                                                <DataGrid Grid.Row="1" ItemsSource="{Binding DishIngredients}" SelectedItem="{Binding SelectedDishIngredient}" AutoGenerateColumns="False" FontSize="11">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="NguyÃªn liá»‡u" Binding="{Binding Ingredient.Name}" Width="*"/>
                                                        <DataGridTextColumn Header="Sá»‘ lÆ°á»£ng (g)" Binding="{Binding Quantity}" Width="130"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Grid>
                                        </Border>

                                        <Border Background="#f7f7f7" CornerRadius="8" Padding="10" Margin="0,8,0,0">
                                            <StackPanel>
                                                <TextBlock Text="ThÃªm nguyÃªn liá»‡u" FontWeight="SemiBold"/>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <ComboBox Grid.Column="0" ItemsSource="{Binding Ingredients}" SelectedItem="{Binding SelectedIngredientToAdd}" DisplayMemberPath="Name" Padding="6" Margin="0,0,6,0"/>
                                                    <TextBox Grid.Column="1" Text="{Binding IngredientQuantity, Mode=TwoWay}" Padding="6" Margin="0,0,6,0"/>
                                                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                        <Button Content="âž• ThÃªm" Command="{Binding AddIngredientCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,6,0"/>
                                                        <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding RemoveIngredientCommand}" Style="{StaticResource DangerButton}"/>
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Class Management View -->
                    <DataTemplate DataType="{x:Type vm:ClassManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Class List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch lá»›p há»c" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Classes}" SelectedItem="{Binding SelectedClass}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn lá»›p" Binding="{Binding Name}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Khá»‘i" Binding="{Binding Grade.Name}" Width="100" MinWidth="80"/>
                                            <DataGridTextColumn Header="SÄ© sá»‘ max" Binding="{Binding Capacity}" Width="80" MinWidth="70"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Class Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin lá»›p há»c" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddClassCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p lá»›p há»c má»›i"/>
                                        </Grid>

                                        <TextBlock Text="TÃªn lá»›p *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedClass.Name, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Khá»‘i *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Grades}" SelectedValue="{Binding SelectedClass.GradeId}" SelectedValuePath="Id" DisplayMemberPath="Name" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="GiÃ¡o viÃªn chá»§ nhiá»‡m" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Teachers}" SelectedValue="{Binding SelectedClass.TeacherId}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ há»c sinh tá»‘i Ä‘a *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedClass.Capacity}" Padding="6" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveClassCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin lá»›p há»c vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteClassCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a lá»›p há»c Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Attendance Management View -->
                    <DataTemplate DataType="{x:Type vm:AttendanceManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Title -->
                            <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                <TextBlock Text="Quáº£n lÃ½ Ä‘iá»ƒm danh" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                            </Border>

                            <!-- Top: Filter Controls -->
                            <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Lá»›p há»c *" Margin="0,0,0,5"/>
                                        <ComboBox ItemsSource="{Binding Classes}" 
                                                  SelectedItem="{Binding SelectedClass}" 
                                                  DisplayMemberPath="Name" 
                                                  Padding="8"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Margin="0,0,15,0">
                                        <TextBlock Text="NgÃ y *" Margin="0,0,0,5"/>
                                        <DatePicker SelectedDate="{Binding SelectedDate}" Padding="8"/>
                                    </StackPanel>

                                    <Button Grid.Column="2" Content="ðŸ“‹ Táº¡o Ä‘iá»ƒm danh" 
                                            Command="{Binding CreateAttendanceCommand}" 
                                            Style="{StaticResource SecondaryButton}" 
                                            VerticalAlignment="Bottom" 
                                            Margin="0,0,10,0"
                                            ToolTip="Táº¡o báº£ng Ä‘iá»ƒm danh cho táº¥t cáº£ há»c sinh trong lá»›p"/>

                                    <Button Grid.Column="3" Content="ðŸ’¾ LÆ°u" 
                                            Command="{Binding SaveAttendanceCommand}" 
                                            Style="{StaticResource PrimaryButton}" 
                                            VerticalAlignment="Bottom"
                                            ToolTip="LÆ°u Ä‘iá»ƒm danh"/>
                                </Grid>
                            </Border>

                            <!-- Bottom: Attendance List -->
                            <Border Grid.Row="2" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                <DataGrid ItemsSource="{Binding Attendances}" 
                                          AutoGenerateColumns="False" 
                                          CanUserAddRows="False">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Lá»›p" Binding="{Binding Class.Name}" Width="120" IsReadOnly="True"/>
                                        <DataGridTemplateColumn Header="Tráº¡ng thÃ¡i" Width="150">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{Binding DataContext.StatusList, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                              SelectedValue="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              SelectedValuePath="Value"
                                                              DisplayMemberPath="Display"
                                                              Padding="5"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Header="Ghi chÃº" Binding="{Binding Notes, UpdateSourceTrigger=PropertyChanged}" Width="200"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <DataTemplate DataType="{x:Type vm:HealthRecordViewModel}">
                        <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="30">
                            <TextBlock Text="Quáº£n lÃ½ sá»©c khá»e" FontSize="24" FontWeight="Bold"/>
                        </Border>
                    </DataTemplate>

                    <DataTemplate DataType="{x:Type vm:MenuManagementViewModel}">
                        <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="30">
                            <TextBlock Text="Quáº£n lÃ½ thá»±c Ä‘Æ¡n" FontSize="24" FontWeight="Bold"/>
                        </Border>
                    </DataTemplate>

                    <DataTemplate DataType="{x:Type vm:InvoiceManagementViewModel}">
                        <TabControl Background="Transparent" Foreground="{StaticResource TextColor}">
                            <!-- Tab 1: Tuition Invoices -->
                            <TabItem Header="ðŸ“š HÃ³a ÄÆ¡n Há»c PhÃ­" Padding="15,8" FontSize="13" FontWeight="Bold">
                                <Grid Background="{StaticResource BackgroundColor}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Create Tuition Invoices -->
                                    <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="15">
                                        <Grid>
                                            <TextBlock Text="ðŸ“‹ Táº¡o HÃ³a ÄÆ¡n HÃ ng Loáº¡t - Há»c PhÃ­ Táº¥t Cáº£ Lá»›p" FontSize="14" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                                                <StackPanel Margin="0,0,15,0">
                                                    <TextBlock Text="ThÃ¡ng" Margin="0,0,0,5" FontSize="11"/>
                                                    <DatePicker Width="130"
                                                                SelectedDate="{Binding InvoiceMonth}"
                                                                SelectedDateFormat="Short"
                                                                Padding="6" FontSize="11"/>
                                                </StackPanel>
                                                <Button Content="âš™ï¸ Táº¡o HÃ³a ÄÆ¡n" Command="{Binding CreateBatchTuitionInvoicesCommand}" Style="{StaticResource PrimaryButton}" Padding="12,5" FontSize="12" VerticalAlignment="Bottom" Margin="0,18,0,0"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Tuition Invoices List with Filter -->
                                    <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15,0,15,15">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                                <TextBlock Text="Danh sÃ¡ch hÃ³a Ä‘Æ¡n há»c phÃ­" FontSize="13" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,15,0"/>
                                                <TextBlock Text="Lá»c theo lá»›p:" Margin="0,0,8,0" FontSize="11" VerticalAlignment="Center"/>
                                                <ComboBox Width="150" ItemsSource="{Binding Classes}" DisplayMemberPath="Name" SelectedItem="{Binding SelectedClassFilter}" Padding="6" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                                <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveInvoiceCommand}" Style="{StaticResource PrimaryButton}" Padding="10,4" FontSize="11" Margin="0,0,10,0"/>
                                                <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteInvoiceCommand}" Style="{StaticResource DangerButton}" Padding="10,4" FontSize="11"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Tuition Invoices Grid -->
                                    <Border Grid.Row="2" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15,0,15,15">
                                        <DataGrid ItemsSource="{Binding TuitionInvoices}" SelectedItem="{Binding SelectedInvoice}" AutoGenerateColumns="False" CanUserAddRows="False" FontSize="11">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Sá»‘ HÄ" Binding="{Binding InvoiceNumber}" Width="90" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Lá»›p" Binding="{Binding Class.Name}" Width="80" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*" MinWidth="120" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Sá»‘ tiá»n" Binding="{Binding Amount, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="NgÃ y phÃ¡t hÃ nh" Binding="{Binding IssueDate, StringFormat=dd/MM/yyyy}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Tráº¡ng thÃ¡i" Binding="{Binding Status}" Width="100" IsReadOnly="True"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Border>

                                    <!-- Details Form -->
                                    <Border Grid.Row="3" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
                                            <StackPanel IsEnabled="{Binding SelectedInvoice, Converter={StaticResource NullToBoolConverter}}">
                                                <TextBlock Text="Chi tiáº¿t hÃ³a Ä‘Æ¡n há»c phÃ­" FontSize="12" FontWeight="Bold" Margin="0,0,0,10" Foreground="{StaticResource PrimaryColor}"/>
                                                
                                                <!-- Row 1: Invoice Number, Student, Class -->
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                        <TextBlock Text="Sá»‘ HÄ" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.InvoiceNumber, Mode=OneWay}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                        <TextBlock Text="Há»c sinh" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.Student.FullName, Mode=OneWay}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2">
                                                        <TextBlock Text="Lá»›p" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.Class.Name, Mode=OneWay}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                </Grid>

                                                <!-- Row 2: Issue Date, Due Date, Status -->
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                        <TextBlock Text="NgÃ y phÃ¡t hÃ nh" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <DatePicker SelectedDate="{Binding SelectedInvoice.IssueDate}" Padding="4" FontSize="10"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                        <TextBlock Text="NgÃ y Ä‘áº¿n háº¡n" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <DatePicker SelectedDate="{Binding SelectedInvoice.DueDate}" Padding="4" FontSize="10"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2">
                                                        <TextBlock Text="Tráº¡ng thÃ¡i" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <ComboBox ItemsSource="{Binding InvoiceStatuses}" SelectedItem="{Binding SelectedInvoice.Status}" Padding="4" FontSize="10"/>
                                                    </StackPanel>
                                                </Grid>

                                                <!-- Row 3: Tuition Fee, Meal Balance, Amount -->
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                        <TextBlock Text="Há»c phÃ­/thÃ¡ng" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.MonthlyTuitionFee, StringFormat=N0}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                        <TextBlock Text="Meal Balance (thÃ¡ng trÆ°á»›c)" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.MealBalanceFromPreviousMonth, StringFormat=N0}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2">
                                                        <TextBlock Text="Sá»‘ tiá»n" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.Amount, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Padding="4" FontSize="10" Background="#FFF9E6"/>
                                                    </StackPanel>
                                                </Grid>

                                                <!-- Row 4: Final Amount -->
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="Sá»‘ tiá»n cuá»‘i cÃ¹ng" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.FinalAmount, StringFormat=N0}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0" Foreground="{StaticResource PrimaryColor}" FontWeight="Bold"/>
                                                    </StackPanel>
                                                </Grid>

                                                <!-- Row 5: Description -->
                                                <StackPanel Margin="0,0,0,0">
                                                    <TextBlock Text="Ghi chÃº" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                    <TextBox Text="{Binding SelectedInvoice.Description, UpdateSourceTrigger=PropertyChanged}" Padding="4" FontSize="10" Height="60" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" AcceptsReturn="True" Background="#FFFBF5"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </TabItem>

                            <!-- Tab 2: Salary Invoices -->
                            <TabItem Header="ðŸ’° Phiáº¿u Tráº£ LÆ°Æ¡ng" Padding="15,8" FontSize="13" FontWeight="Bold">
                                <Grid Background="{StaticResource BackgroundColor}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Create Salary Invoices -->
                                    <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="15">
                                        <Grid>
                                            <TextBlock Text="ðŸ“‹ Táº¡o Phiáº¿u Tráº£ LÆ°Æ¡ng HÃ ng Loáº¡t" FontSize="14" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                                                <StackPanel Margin="0,0,15,0">
                                                    <TextBlock Text="ThÃ¡ng" Margin="0,0,0,5" FontSize="11"/>
                                                    <DatePicker Width="130"
                                                                SelectedDate="{Binding InvoiceMonth}"
                                                                SelectedDateFormat="Short"
                                                                Padding="6" FontSize="11"/>
                                                </StackPanel>
                                                <Button Content="âš™ï¸ Táº¡o Phiáº¿u LÆ°Æ¡ng" Command="{Binding CreateBatchSalaryInvoicesCommand}" Style="{StaticResource PrimaryButton}" Padding="12,5" FontSize="12" VerticalAlignment="Bottom" Margin="0,18,0,0"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Salary Invoices List -->
                                    <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15,0,15,15">
                                        <Grid>
                                            <TextBlock Text="Danh sÃ¡ch phiáº¿u lÆ°Æ¡ng" FontSize="13" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                                                <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveInvoiceCommand}" Style="{StaticResource PrimaryButton}" Padding="10,4" FontSize="11" Margin="0,0,10,0"/>
                                                <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteInvoiceCommand}" Style="{StaticResource DangerButton}" Padding="10,4" FontSize="11"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Salary Invoices Grid -->
                                    <Border Grid.Row="2" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15,0,15,15">
                                        <DataGrid ItemsSource="{Binding SalaryInvoices}" SelectedItem="{Binding SelectedInvoice}" AutoGenerateColumns="False" CanUserAddRows="False" FontSize="11">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Sá»‘ HÄ" Binding="{Binding InvoiceNumber}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="NhÃ¢n viÃªn" Binding="{Binding User.FullName}" Width="*" MinWidth="150" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Chá»©c vá»¥" Binding="{Binding User.Position}" Width="120" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Sá»‘ tiá»n" Binding="{Binding Amount, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="NgÃ y phÃ¡t hÃ nh" Binding="{Binding IssueDate, StringFormat=dd/MM/yyyy}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Tráº¡ng thÃ¡i" Binding="{Binding Status}" Width="100" IsReadOnly="True"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Border>

                                    <!-- Salary Details Form -->
                                    <Border Grid.Row="3" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
                                            <StackPanel IsEnabled="{Binding SelectedInvoice, Converter={StaticResource NullToBoolConverter}}">
                                                <TextBlock Text="Chi tiáº¿t phiáº¿u lÆ°Æ¡ng" FontSize="12" FontWeight="Bold" Margin="0,0,0,10" Foreground="{StaticResource PrimaryColor}"/>
                                                
                                                <!-- Row 1: Invoice Number, Staff, Position -->
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                        <TextBlock Text="Sá»‘ HÄ" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.InvoiceNumber, Mode=OneWay}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                        <TextBlock Text="NhÃ¢n viÃªn" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.User.FullName, Mode=OneWay}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2">
                                                        <TextBlock Text="Chá»©c vá»¥" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.User.Position, Mode=OneWay}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                </Grid>

                                                <!-- Row 2: Issue Date, Salary, Allowance -->
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                        <TextBlock Text="ThÃ¡ng lÆ°Æ¡ng" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <DatePicker SelectedDate="{Binding SelectedInvoice.IssueDate}" Padding="4" FontSize="10"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                        <TextBlock Text="LÆ°Æ¡ng cÆ¡ báº£n" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.MonthlyTuitionFee, StringFormat=N0}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2">
                                                        <TextBlock Text="Phá»¥ cáº¥p" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.MealBalanceFromPreviousMonth, StringFormat=N0}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0"/>
                                                    </StackPanel>
                                                </Grid>

                                                <!-- Row 3: Status, Amount -->
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                        <TextBlock Text="Tráº¡ng thÃ¡i" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <ComboBox ItemsSource="{Binding InvoiceStatuses}" SelectedItem="{Binding SelectedInvoice.Status}" Padding="4" FontSize="10"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="Tá»•ng tiá»n lÆ°Æ¡ng" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                        <TextBox Text="{Binding SelectedInvoice.Amount, StringFormat=N0}" Padding="4" FontSize="10" IsReadOnly="True" Background="#F0F0F0" Foreground="{StaticResource PrimaryColor}" FontWeight="Bold"/>
                                                    </StackPanel>
                                                </Grid>

                                                <!-- Row 4: Description -->
                                                <StackPanel Margin="0,0,0,0">
                                                    <TextBlock Text="Ghi chÃº" Margin="0,0,0,3" FontSize="10" FontWeight="SemiBold"/>
                                                    <TextBox Text="{Binding SelectedInvoice.Description, UpdateSourceTrigger=PropertyChanged}" Padding="4" FontSize="10" Height="60" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" AcceptsReturn="True" Background="#FFFBF5"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </TabItem>

                            <!-- Tab 3: Other Invoices -->
                            <TabItem Header="ðŸ”§ HÃ³a ÄÆ¡n KhÃ¡c" Padding="15,8" FontSize="13" FontWeight="Bold">
                                <Grid Background="{StaticResource BackgroundColor}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Action Buttons -->
                                    <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15">
                                        <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding CreateInvoiceCommand}" Style="{StaticResource SecondaryButton}" Padding="10,4" FontSize="11" Margin="0,0,10,0"/>
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveInvoiceCommand}" Style="{StaticResource PrimaryButton}" Padding="10,4" FontSize="11" Margin="0,0,10,0"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteInvoiceCommand}" Style="{StaticResource DangerButton}" Padding="10,4" FontSize="11"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Other Invoices Grid -->
                                    <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15">
                                        <DataGrid ItemsSource="{Binding OtherInvoices}" SelectedItem="{Binding SelectedInvoice}" AutoGenerateColumns="False" CanUserAddRows="False" FontSize="11">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Sá»‘ HÄ" Binding="{Binding InvoiceNumber}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Loáº¡i" Binding="{Binding Type}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Sá»‘ tiá»n" Binding="{Binding Amount, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="NgÃ y phÃ¡t hÃ nh" Binding="{Binding IssueDate, StringFormat=dd/MM/yyyy}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Tráº¡ng thÃ¡i" Binding="{Binding Status}" Width="100" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="Ghi chÃº" Binding="{Binding Description}" Width="*" MinWidth="200" IsReadOnly="True"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Border>

                                    <!-- Details Form -->
                                    <Border Grid.Row="2" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="15">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="200">
                                            <StackPanel IsEnabled="{Binding SelectedInvoice, Converter={StaticResource NullToBoolConverter}}">
                                                <TextBlock Text="Chi tiáº¿t hÃ³a Ä‘Æ¡n" FontSize="12" FontWeight="Bold" Margin="0,0,0,10"/>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                        <TextBlock Text="Loáº¡i" Margin="0,0,0,3" FontSize="10"/>
                                                        <ComboBox ItemsSource="{Binding OtherInvoiceTypes}" SelectedItem="{Binding SelectedInvoice.Type}" Padding="4" FontSize="10"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="Sá»‘ tiá»n" Margin="0,0,0,3" FontSize="10"/>
                                                        <TextBox Text="{Binding SelectedInvoice.Amount, UpdateSourceTrigger=PropertyChanged}" Padding="4" FontSize="10"/>
                                                    </StackPanel>
                                                </Grid>
                                                <TextBlock Text="Ghi chÃº" Margin="0,8,0,3" FontSize="10"/>
                                                <TextBox Text="{Binding SelectedInvoice.Description, UpdateSourceTrigger=PropertyChanged}" Padding="4" FontSize="10" Height="60" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" AcceptsReturn="True"/>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </TabItem>
                        </TabControl>
                    </DataTemplate>

                    <!-- Account Management View -->
                    <DataTemplate DataType="{x:Type vm:AccountManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Account List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch tÃ i khoáº£n" FontSize="24" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                    <DataGrid ItemsSource="{Binding Accounts}" SelectedItem="{Binding SelectedAccount}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn Ä‘Äƒng nháº­p" Binding="{Binding Username}" Width="*"/>
                                            <DataGridTextColumn Header="Email" Binding="{Binding User.Email}" Width="*"/>
                                            <DataGridTextColumn Header="Vai trÃ²" Binding="{Binding Role.Name}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Account Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <TextBlock Text="ThÃ´ng tin tÃ i khoáº£n" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,20"/>

                                        <TextBlock Text="TÃªn Ä‘Äƒng nháº­p *" Margin="0,0,0,5"/>
                                        <TextBox Text="{Binding SelectedAccount.Username, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Máº­t kháº©u *" Margin="0,0,0,5"/>
                                        <PasswordBox Padding="8" Margin="0,0,0,15"
                                                     util:PasswordBoxHelper.BindPassword="True"
                                                     util:PasswordBoxHelper.BoundPassword="{Binding NewPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                        <TextBlock Text="NhÃ¢n viÃªn *" Margin="0,0,0,5"/>
                                        <ComboBox ItemsSource="{Binding Users}" 
                                                  SelectedValue="{Binding SelectedUserId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="FullName" 
                                                  Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Email (tá»« nhÃ¢n viÃªn)" Margin="0,0,0,5" Foreground="Gray"/>
                                        <TextBox Text="{Binding SelectedUserEmail, Mode=OneWay}" 
                                                 IsReadOnly="True" 
                                                 Background="#F5F5F5"
                                                 Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Chá»©c vá»¥ (tá»« nhÃ¢n viÃªn)" Margin="0,0,0,5" Foreground="Gray"/>
                                        <TextBox Text="{Binding SelectedUserPosition, Mode=OneWay}" 
                                                 IsReadOnly="True" 
                                                 Background="#F5F5F5"
                                                 Padding="8" Margin="0,0,0,15"/>

                                        <TextBlock Text="Vai trÃ² * (tá»± Ä‘á»™ng theo chá»©c vá»¥)" Margin="0,0,0,5"/>
                                        <ComboBox ItemsSource="{Binding Roles}" 
                                                  SelectedValue="{Binding SelectedAccount.RoleId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="Name" 
                                                  Padding="8" Margin="0,0,0,15"/>

                                        <CheckBox Content="KÃ­ch hoáº¡t tÃ i khoáº£n" IsChecked="{Binding SelectedAccount.IsActive, Mode=TwoWay}" Margin="0,0,0,20"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddAccountCommand}" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p tÃ i khoáº£n má»›i"/>
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveAccountCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" ToolTip="LÆ°u thÃ´ng tin tÃ i khoáº£n vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteAccountCommand}" Style="{StaticResource DangerButton}" ToolTip="XÃ³a tÃ i khoáº£n Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Staff Management View -->
                    <DataTemplate DataType="{x:Type vm:StaffManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Staff List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch nhÃ¢n viÃªn" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Staff}" SelectedItem="{Binding SelectedStaff}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há» vÃ  tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="*" MinWidth="120"/>
                                            <DataGridTextColumn Header="Chá»©c vá»¥" Binding="{Binding Position}" Width="100" MinWidth="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Staff Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin nhÃ¢n viÃªn" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddStaffCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p nhÃ¢n viÃªn má»›i"/>
                                        </Grid>

                                        <TextBlock Text="Há» vÃ  tÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.FullName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Email *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ Ä‘iá»‡n thoáº¡i" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.PhoneNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Chá»©c vá»¥ *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox Text="{Binding SelectedStaff.Position, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEditable="True" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="GiÃ¡o viÃªn"/>
                                            <ComboBoxItem Content="Hiá»‡u trÆ°á»Ÿng"/>
                                            <ComboBoxItem Content="PhÃ³ hiá»‡u trÆ°á»Ÿng"/>
                                            <ComboBoxItem Content="Káº¿ toÃ¡n"/>
                                            <ComboBoxItem Content="Y tÃ¡"/>
                                        </ComboBox>

                                        <TextBlock Text="LÆ°Æ¡ng cÆ¡ báº£n" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Salary, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Phá»¥ cáº¥p" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Allowance, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="ChuyÃªn mÃ´n" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedStaff.Specialization, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveStaffCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin nhÃ¢n viÃªn vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteStaffCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a nhÃ¢n viÃªn Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Parent Management View -->
                    <DataTemplate DataType="{x:Type vm:ParentManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="350"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Parent List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch phá»¥ huynh" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Parents}" SelectedItem="{Binding SelectedParent}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há» vÃ  tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="*" MinWidth="120"/>
                                            <DataGridTextColumn Header="ÄT" Binding="{Binding PhoneNumber}" Width="100" MinWidth="90"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Parent Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin phá»¥ huynh" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddParentCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p phá»¥ huynh má»›i"/>
                                        </Grid>

                                        <TextBlock Text="Há» vÃ  tÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.FullName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Email *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ Ä‘iá»‡n thoáº¡i *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.PhoneNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Nghá» nghiá»‡p" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.Occupation, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Äá»‹a chá»‰" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedParent.Address, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,15" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveParentCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin phá»¥ huynh vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteParentCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a phá»¥ huynh Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Staff Leave Management View -->
                    <DataTemplate DataType="{x:Type vm:StaffLeaveManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="*" MinWidth="400"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Staff Leave List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch Ä‘Æ¡n nghá»‰ nhÃ¢n viÃªn" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding StaffLeaves}" SelectedItem="{Binding SelectedLeave, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="NhÃ¢n viÃªn" Binding="{Binding User.FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="Tá»«" Binding="{Binding StartDate, StringFormat={}{0:dd/MM/yyyy}}" Width="80" MinWidth="70"/>
                                            <DataGridTextColumn Header="Äáº¿n" Binding="{Binding EndDate, StringFormat={}{0:dd/MM/yyyy}}" Width="80" MinWidth="70"/>
                                            <DataGridTextColumn Header="Loáº¡i" Binding="{Binding LeaveType, Converter={StaticResource StatusToVietnameseConverter}}" Width="100" MinWidth="90"/>
                                            <DataGridTextColumn Header="TT" Binding="{Binding Status, Converter={StaticResource StatusToVietnameseConverter}}" Width="90" MinWidth="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Staff Leave Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin Ä‘Æ¡n nghá»‰" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddLeaveCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12" ToolTip="Táº¡o form trá»‘ng Ä‘á»ƒ nháº­p Ä‘Æ¡n nghá»‰ má»›i"/>
                                        </Grid>

                                        <TextBlock Text="NhÃ¢n viÃªn *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Users}" 
                                                  SelectedValue="{Binding SelectedLeave.UserId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="FullName"
                                                  IsEnabled="{Binding CanSelectUser}"
                                                  Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Tá»« ngÃ y *" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedLeave.StartDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                    Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Äáº¿n ngÃ y *" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedLeave.EndDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                    Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Loáº¡i nghá»‰ *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding SelectedLeave.LeaveType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Tag" 
                                                  Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Nghá»‰ phÃ©p" Tag="Vacation"/>
                                            <ComboBoxItem Content="Nghá»‰ á»‘m" Tag="Sick"/>
                                            <ComboBoxItem Content="Nghá»‰ cÃ¡ nhÃ¢n" Tag="Personal"/>
                                            <ComboBoxItem Content="Nghá»‰ khÃ´ng lÆ°Æ¡ng" Tag="Unpaid"/>
                                        </ComboBox>

                                        <TextBlock Text="LÃ½ do *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedLeave.Reason, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Tráº¡ng thÃ¡i" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding TempStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedValuePath="Tag"
                                                  IsEnabled="{Binding CanEditStatus}"
                                                  Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Chá» duyá»‡t" Tag="Pending"/>
                                            <ComboBoxItem Content="ÄÃ£ duyá»‡t" Tag="Approved"/>
                                            <ComboBoxItem Content="Tá»« chá»‘i" Tag="Rejected"/>
                                        </ComboBox>

                                        <TextBlock Text="Ghi chÃº duyá»‡t" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedLeave.ApprovalNotes, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="6" Margin="0,0,0,15" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"
                                                 IsReadOnly="{Binding CanEditApprovalNotes, Converter={StaticResource InverseBooleanConverter}}"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveLeaveCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12" ToolTip="LÆ°u thÃ´ng tin Ä‘Æ¡n nghá»‰ vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteLeaveCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12" ToolTip="XÃ³a Ä‘Æ¡n nghá»‰ Ä‘Ã£ chá»n"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Vaccine Management View -->
                    <DataTemplate DataType="{x:Type vm:VaccineManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="3*" MinWidth="400"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Vaccine List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <Grid>
                                        <TextBlock Text="Danh sÃ¡ch Vaccine" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                        <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5" FontSize="12"/>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding Vaccines}" SelectedItem="{Binding SelectedVaccine, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="TÃªn Vaccine" Binding="{Binding Name}" Width="*" MinWidth="120"/>
                                            <DataGridTextColumn Header="Tuá»•i (th)" Binding="{Binding RequiredAgeMonths}" Width="80" MinWidth="70"/>
                                            <DataGridCheckBoxColumn Header="BB" Binding="{Binding IsMandatory}" Width="60" MinWidth="50"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Vaccine Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin Vaccine" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddVaccineCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12"/>
                                        </Grid>

                                        <TextBlock Text="TÃªn Vaccine *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="MÃ´ táº£" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Tuá»•i yÃªu cáº§u (thÃ¡ng) *" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.RequiredAgeMonths, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Bá»‡nh phÃ²ng ngá»«a" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedVaccine.DiseasesPrevented, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <CheckBox Content="Vaccine báº¯t buá»™c" IsChecked="{Binding SelectedVaccine.IsMandatory, Mode=TwoWay}" Margin="0,0,0,15" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveVaccineCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteVaccineCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Vaccination Record Management View -->
                    <DataTemplate DataType="{x:Type vm:VaccinationRecordManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Record List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="Há»“ sÆ¡ tiÃªm chá»§ng" FontSize="24" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
                                        </Grid>

                                        <!-- Filter Section -->
                                        <TextBlock Text="ðŸ” Lá»c theo:" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="10"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Há»c sinh" Margin="0,0,0,5" FontSize="12"/>
                                                <ComboBox ItemsSource="{Binding Students}" 
                                                          SelectedValue="{Binding FilterStudentId, Mode=TwoWay}" 
                                                          SelectedValuePath="Id" 
                                                          DisplayMemberPath="FullName" 
                                                          Padding="6" 
                                                          FontSize="12">
                                                    <ComboBox.ItemContainerStyle>
                                                        <Style TargetType="ComboBoxItem">
                                                            <Setter Property="Padding" Value="5"/>
                                                        </Style>
                                                    </ComboBox.ItemContainerStyle>
                                                </ComboBox>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="Vaccine" Margin="0,0,0,5" FontSize="12"/>
                                                <ComboBox ItemsSource="{Binding Vaccines}" 
                                                          SelectedValue="{Binding FilterVaccineId, Mode=TwoWay}" 
                                                          SelectedValuePath="Id" 
                                                          DisplayMemberPath="Name" 
                                                          Padding="6" 
                                                          FontSize="12">
                                                    <ComboBox.ItemContainerStyle>
                                                        <Style TargetType="ComboBoxItem">
                                                            <Setter Property="Padding" Value="5"/>
                                                        </Style>
                                                    </ComboBox.ItemContainerStyle>
                                                </ComboBox>
                                            </StackPanel>
                                        </Grid>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                                            <Button Content="ðŸ” Lá»c" Command="{Binding ApplyFilterCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" Padding="15,5"/>
                                            <Button Content="ðŸ”„ XÃ³a lá»c" Command="{Binding ClearFilterCommand}" Style="{StaticResource SecondaryButton}" Padding="15,5"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20">
                                    <DataGrid ItemsSource="{Binding FilteredRecords}" SelectedItem="{Binding SelectedRecord, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*"/>
                                            <DataGridTextColumn Header="Vaccine" Binding="{Binding Vaccine.Name}" Width="*"/>
                                            <DataGridTextColumn Header="Tráº¡ng thÃ¡i" Binding="{Binding Status}" Width="100"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Record Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin tiÃªm chá»§ng" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddRecordCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12"/>
                                        </Grid>

                                        <TextBlock Text="Há»c sinh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Students}" SelectedValue="{Binding SelectedRecord.StudentId, Mode=TwoWay}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Vaccine *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Vaccines}" SelectedValue="{Binding SelectedRecord.VaccineId, Mode=TwoWay}" SelectedValuePath="Id" DisplayMemberPath="Name" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Tráº¡ng thÃ¡i" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding SelectedRecord.Status, Mode=TwoWay}" SelectedValuePath="Tag" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="ChÆ°a tiÃªm" Tag="Not Done"/>
                                            <ComboBoxItem Content="ÄÃ£ tiÃªm" Tag="Done"/>
                                            <ComboBoxItem Content="ÄÃ£ lÃªn lá»‹ch" Tag="Scheduled"/>
                                        </ComboBox>

                                        <TextBlock Text="NgÃ y tiÃªm" Margin="0,0,0,5" FontSize="12"/>
                                        <DatePicker SelectedDate="{Binding SelectedRecord.VaccinationDate, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="ÄÆ¡n vá»‹ y táº¿" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.MedicalUnit, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Sá»‘ lÃ´" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.LotNumber, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <TextBlock Text="Ghi chÃº" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.Notes, Mode=TwoWay}" Padding="6" Margin="0,0,0,15" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveRecordCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteRecordCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Health Record Management View -->
                    <DataTemplate DataType="{x:Type vm:HealthRecordManagementViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" MinWidth="300"/>
                                <ColumnDefinition Width="3*" MinWidth="400"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left: Health Record List -->
                            <Grid Grid.Column="0" Margin="0,0,10,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="Há»“ sÆ¡ sá»©c khá»e hÃ ng thÃ¡ng" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadDataCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="10,5"/>
                                        </Grid>

                                        <!-- Filter Section -->
                                        <TextBlock Text="ðŸ” Lá»c theo lá»›p há»c:" FontSize="13" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                        
                                        <ComboBox ItemsSource="{Binding Classes}" 
                                                  SelectedValue="{Binding FilterClassId, Mode=TwoWay}" 
                                                  SelectedValuePath="Id" 
                                                  DisplayMemberPath="Name" 
                                                  Padding="6" 
                                                  FontSize="12"
                                                  Margin="0,0,0,8"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ” Lá»c" Command="{Binding ApplyFilterCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="12,5" FontSize="12"/>
                                            <Button Content="ðŸ”„ XÃ³a lá»c" Command="{Binding ClearFilterCommand}" Style="{StaticResource SecondaryButton}" Padding="12,5" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Students List (visible when class is filtered) -->
                                <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,10">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Text="ðŸ‘¥ Danh sÃ¡ch há»c sinh" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                        
                                        <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredStudents}" SelectedItem="{Binding SelectedStudent, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="MÃ£ HS" Binding="{Binding Code}" Width="70" MinWidth="70"/>
                                                <DataGridTextColumn Header="Há» tÃªn" Binding="{Binding FullName}" Width="*" MinWidth="120"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="2" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                    <DataGrid ItemsSource="{Binding FilteredRecords}" SelectedItem="{Binding SelectedRecord, Mode=TwoWay}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Há»c sinh" Binding="{Binding Student.FullName}" Width="*" MinWidth="100"/>
                                            <DataGridTextColumn Header="ThÃ¡ng/NÄƒm" Width="80" MinWidth="80">
                                                <DataGridTextColumn.Binding>
                                                    <MultiBinding StringFormat="{}{0}/{1}">
                                                        <Binding Path="Month"/>
                                                        <Binding Path="Year"/>
                                                    </MultiBinding>
                                                </DataGridTextColumn.Binding>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="CC(cm)" Binding="{Binding Height}" Width="70" MinWidth="70"/>
                                            <DataGridTextColumn Header="CN(kg)" Binding="{Binding Weight}" Width="70" MinWidth="70"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                            </Grid>

                            <!-- Right: Health Record Form -->
                            <Border Grid.Column="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,15">
                                            <TextBlock Text="ThÃ´ng tin sá»©c khá»e" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                                            <Button Content="âž• Táº¡o má»›i" Command="{Binding AddRecordCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right" Padding="12,5" FontSize="12"/>
                                        </Grid>

                                        <TextBlock Text="Há»c sinh *" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox ItemsSource="{Binding Students}" SelectedValue="{Binding SelectedRecord.StudentId, Mode=TwoWay}" SelectedValuePath="Id" DisplayMemberPath="FullName" Padding="6" Margin="0,0,0,12" FontSize="12"/>

                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="10"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="ThÃ¡ng *" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Month, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="NÄƒm *" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Year, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>
                                        </Grid>

                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="10"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Chiá»u cao (cm)" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Height, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="CÃ¢n náº·ng (kg)" Margin="0,0,0,5" FontSize="12"/>
                                                <TextBox Text="{Binding SelectedRecord.Weight, Mode=TwoWay}" Padding="6" FontSize="12"/>
                                            </StackPanel>
                                        </Grid>

                                        <TextBlock Text="Sá»©c khá»e tá»•ng quÃ¡t" Margin="0,0,0,5" FontSize="12"/>
                                        <ComboBox SelectedValue="{Binding SelectedRecord.GeneralHealth, Mode=TwoWay}" SelectedValuePath="Tag" Padding="6" Margin="0,0,0,12" FontSize="12">
                                            <ComboBoxItem Content="Tá»‘t" Tag="Good"/>
                                            <ComboBoxItem Content="KhÃ¡" Tag="Fair"/>
                                            <ComboBoxItem Content="Yáº¿u" Tag="Poor"/>
                                        </ComboBox>

                                        <TextBlock Text="TÃ¬nh tráº¡ng bá»‡nh lÃ½" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.MedicalConditions, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Nháº­n xÃ©t cá»§a giÃ¡o viÃªn" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.TeacherComments, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="ÄÃ¡nh giÃ¡ cá»§a giÃ¡o viÃªn" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.TeacherEvaluation, Mode=TwoWay}" Padding="6" Margin="0,0,0,12" Height="60" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <TextBlock Text="Ghi chÃº" Margin="0,0,0,5" FontSize="12"/>
                                        <TextBox Text="{Binding SelectedRecord.Notes, Mode=TwoWay}" Padding="6" Margin="0,0,0,15" Height="50" TextWrapping="Wrap" AcceptsReturn="True" FontSize="12"/>

                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="ðŸ’¾ LÆ°u" Command="{Binding SaveRecordCommand}" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Padding="15,6" FontSize="12"/>
                                            <Button Content="ðŸ—‘ï¸ XÃ³a" Command="{Binding DeleteRecordCommand}" Style="{StaticResource DangerButton}" Padding="15,6" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </DataTemplate>

                    <!-- Reporting View -->
                    <DataTemplate DataType="{x:Type vm:ReportingViewModel}">
                        <Grid util:AdaptiveGridBehavior.IsEnabled="True"
                              util:AdaptiveGridBehavior.Breakpoint="1100">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Title -->
                            <Border Grid.Row="0" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                <TextBlock Text="ðŸ“ˆ BÃ¡o cÃ¡o vÃ  Thá»‘ng kÃª" FontSize="20" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" VerticalAlignment="Center"/>
                            </Border>

                            <!-- Date Range Filter -->
                            <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="20" Margin="0,0,0,15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Tá»« ngÃ y" Margin="0,0,0,5"/>
                                        <DatePicker SelectedDate="{Binding FromDate, Mode=TwoWay}" Padding="6"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Margin="0,0,15,0">
                                        <TextBlock Text="Äáº¿n ngÃ y" Margin="0,0,0,5"/>
                                        <DatePicker SelectedDate="{Binding ToDate, Mode=TwoWay}" Padding="6"/>
                                    </StackPanel>

                                    <Button Grid.Column="2" Content="ðŸ”„ Táº£i láº¡i" Command="{Binding LoadReportsCommand}" Style="{StaticResource PrimaryButton}" VerticalAlignment="Bottom" ToolTip="Táº£i láº¡i táº¥t cáº£ bÃ¡o cÃ¡o"/>
                                </Grid>
                            </Border>

                            <!-- Reports Content -->
                            <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <!-- Financial Report Section -->
                                    <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ’° BÃ¡o cÃ¡o tÃ i chÃ­nh" FontSize="16" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,12"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                    <TextBlock Text="Tá»•ng hÃ³a Ä‘Æ¡n" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding FinancialReport.TotalInvoices}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                    <TextBlock Text="Doanh thu" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding FinancialReport.TotalIncome, StringFormat={}{0:N0}Ä‘}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="2">
                                                    <TextBlock Text="ChÆ°a thanh toÃ¡n" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding FinancialReport.UnpaidIncome, StringFormat={}{0:N0}Ä‘}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource DangerColor}"/>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>

                                    <!-- Health Statistics Section -->
                                    <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ¥ Thá»‘ng kÃª sá»©c khá»e" FontSize="16" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,12"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                    <TextBlock Text="Kiá»ƒm tra sá»©c khá»e" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding HealthStatistics.TotalHealthChecks}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                    <TextBlock Text="Khá»e máº¡nh" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding HealthStatistics.HealthyCount}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource SuccessColor}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                                    <TextBlock Text="Cáº§n chÃº Ã½" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding HealthStatistics.NeedAttentionCount}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource WarningColor}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="3">
                                                    <TextBlock Text="CÃ¢n náº·ng TB (kg)" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding HealthStatistics.AverageWeight, StringFormat={}{0:F2}}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>

                                    <!-- Vaccination Statistics Section -->
                                    <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15" Margin="0,0,0,15">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ’‰ Thá»‘ng kÃª tiÃªm chá»§ng" FontSize="16" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,12"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                                    <TextBlock Text="Tá»•ng há»c sinh" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding VaccinationStatistics.TotalStudents}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                                    <TextBlock Text="ÄÃ£ tiÃªm chá»§ng" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding VaccinationStatistics.VaccinatedCount}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource SuccessColor}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="2">
                                                    <TextBlock Text="Tá»· lá»‡ (%)" FontSize="12" Foreground="{StaticResource TextSecondaryColor}"/>
                                                    <TextBlock Text="{Binding VaccinationStatistics.VaccinationPercentage, StringFormat={}{0:F1}%}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>

                                    <!-- Class Reports Section -->
                                    <Border Background="{StaticResource SurfaceColor}" CornerRadius="10" Padding="15">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ« BÃ¡o cÃ¡o lá»›p há»c" FontSize="16" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,12"/>
                                            <DataGrid ItemsSource="{Binding ClassReports}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="12">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="TÃªn lá»›p" Binding="{Binding ClassName}" Width="150"/>
                                                    <DataGridTextColumn Header="Khá»‘i" Binding="{Binding GradeName}" Width="100"/>
                                                    <DataGridTextColumn Header="Sá»‘ há»c sinh" Binding="{Binding TotalStudents}" Width="80"/>
                                                    <DataGridTextColumn Header="Äiá»ƒm danh (%)" Binding="{Binding AverageAttendancePercentage, StringFormat={}{0:F1}}" Width="100"/>
                                                    <DataGridTextColumn Header="Kiá»ƒm tra SK" Binding="{Binding TotalHealthChecks}" Width="100"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </DataTemplate>
                </ContentControl.Resources>
            </ContentControl>
        </Border>
    </Grid>
</Window>
